# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: ubuntu-latest

variables:
  buildConfiguration: 'Release'

steps:
- task: UseDotNet@2
  displayName: 'Use .NET SDK 9.0.205'
  inputs:
    packageType: sdk
    version: '9.0.205'

- task: CmdLine@2
  inputs:
    script: |
      # Download the installer (if not already present on the agent)
      # Invoke-WebRequest -Uri "https://download.microsoft.com/download/..." -OutFile "NDP472-KB4054530-x86-x64-AllOS-ENU.exe"

      # Execute the silent installation
      .\NDP472-KB4054530-x86-x64-AllOS-ENU.exe /q /norestart

- script: 'echo "$(buildConfiguration), $(Build.DefinitionName), $(Build.BuildId), $(Build.BuildNumber)" > buildinfo.txt'
  displayName: 'Write build info'
  workingDirectory: $(System.DefaultWorkingDirectory)

- task: DotNetCoreCLI@2
  displayName: 'Restore project dependencies'
  inputs:
    command: 'restore'
    projects: '**/*.csproj'

- task: DotNetCoreCLI@2
  displayName: 'Build the project - $(buildConfiguration)'
  inputs:
    command: 'build'
    arguments: '--no-restore --configuration $(buildConfiguration)'
    projects: '**/*.csproj'
